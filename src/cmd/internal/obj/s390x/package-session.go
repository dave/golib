package s390x

import (
	"github.com/dave/golib/src/cmd/internal/obj"
	"github.com/dave/golib/src/cmd/internal/objabi"
	"github.com/dave/golib/src/cmd/internal/sys"
)

type PackageSession struct {
	obj    *obj.PackageSession
	objabi *objabi.PackageSession
	sys    *sys.PackageSession

	Anames []string

	Links390x           obj.LinkArch
	S390XDWARFRegisters map[int16]int16
	cnamesz             []string

	oprange [688][]Optab
	optab   []Optab

	unaryDst map[obj.As]bool
	xcmp     [30][30]bool
}

func NewPackageSession(obj_psess *obj.PackageSession, objabi_psess *objabi.PackageSession, sys_psess *sys.PackageSession) *PackageSession {
	psess := &PackageSession{}
	psess.obj = obj_psess
	psess.objabi = objabi_psess
	psess.sys = sys_psess
	psess.S390XDWARFRegisters = map[int16]int16{}
	psess.unaryDst = map[obj.As]bool{
		ASTCK:  true,
		ASTCKC: true,
		ASTCKE: true,
		ASTCKF: true,
		ANEG:   true,
		ANEGW:  true,
		AVONE:  true,
		AVZERO: true,
	}
	psess.Anames = []string{
		obj.A_ARCHSPECIFIC: "ADD",
		"ADDC",
		"ADDE",
		"ADDW",
		"DIVW",
		"DIVWU",
		"DIVD",
		"DIVDU",
		"MODW",
		"MODWU",
		"MODD",
		"MODDU",
		"MULLW",
		"MULLD",
		"MULHD",
		"MULHDU",
		"SUB",
		"SUBC",
		"SUBV",
		"SUBE",
		"SUBW",
		"NEG",
		"NEGW",
		"MOVWBR",
		"MOVB",
		"MOVBZ",
		"MOVH",
		"MOVHBR",
		"MOVHZ",
		"MOVW",
		"MOVWZ",
		"MOVD",
		"MOVDBR",
		"MOVDEQ",
		"MOVDGE",
		"MOVDGT",
		"MOVDLE",
		"MOVDLT",
		"MOVDNE",
		"FLOGR",
		"AND",
		"ANDW",
		"OR",
		"ORW",
		"XOR",
		"XORW",
		"SLW",
		"SLD",
		"SRW",
		"SRAW",
		"SRD",
		"SRAD",
		"RLL",
		"RLLG",
		"FABS",
		"FADD",
		"FADDS",
		"FCMPO",
		"FCMPU",
		"CEBR",
		"FDIV",
		"FDIVS",
		"FMADD",
		"FMADDS",
		"FMOVD",
		"FMOVS",
		"FMSUB",
		"FMSUBS",
		"FMUL",
		"FMULS",
		"FNABS",
		"FNEG",
		"FNEGS",
		"LEDBR",
		"LDEBR",
		"LPDFR",
		"LNDFR",
		"FSUB",
		"FSUBS",
		"FSQRT",
		"FSQRTS",
		"FIEBR",
		"FIDBR",
		"CPSDR",
		"LTEBR",
		"LTDBR",
		"TCEB",
		"TCDB",
		"LDGR",
		"LGDR",
		"CEFBRA",
		"CDFBRA",
		"CEGBRA",
		"CDGBRA",
		"CFEBRA",
		"CFDBRA",
		"CGEBRA",
		"CGDBRA",
		"CELFBR",
		"CDLFBR",
		"CELGBR",
		"CDLGBR",
		"CLFEBR",
		"CLFDBR",
		"CLGEBR",
		"CLGDBR",
		"CMP",
		"CMPU",
		"CMPW",
		"CMPWU",
		"TMHH",
		"TMHL",
		"TMLH",
		"TMLL",
		"CS",
		"CSG",
		"SYNC",
		"BC",
		"BCL",
		"BEQ",
		"BGE",
		"BGT",
		"BLE",
		"BLT",
		"BLEU",
		"BLTU",
		"BNE",
		"BVC",
		"BVS",
		"SYSCALL",
		"CMPBEQ",
		"CMPBGE",
		"CMPBGT",
		"CMPBLE",
		"CMPBLT",
		"CMPBNE",
		"CMPUBEQ",
		"CMPUBGE",
		"CMPUBGT",
		"CMPUBLE",
		"CMPUBLT",
		"CMPUBNE",
		"MVC",
		"CLC",
		"XC",
		"OC",
		"NC",
		"EXRL",
		"LARL",
		"LA",
		"LAY",
		"LAA",
		"LAAG",
		"LAAL",
		"LAALG",
		"LAN",
		"LANG",
		"LAX",
		"LAXG",
		"LAO",
		"LAOG",
		"LMY",
		"LMG",
		"STMY",
		"STMG",
		"STCK",
		"STCKC",
		"STCKE",
		"STCKF",
		"CLEAR",
		"VA",
		"VAB",
		"VAH",
		"VAF",
		"VAG",
		"VAQ",
		"VACC",
		"VACCB",
		"VACCH",
		"VACCF",
		"VACCG",
		"VACCQ",
		"VAC",
		"VACQ",
		"VACCC",
		"VACCCQ",
		"VN",
		"VNC",
		"VAVG",
		"VAVGB",
		"VAVGH",
		"VAVGF",
		"VAVGG",
		"VAVGL",
		"VAVGLB",
		"VAVGLH",
		"VAVGLF",
		"VAVGLG",
		"VCKSM",
		"VCEQ",
		"VCEQB",
		"VCEQH",
		"VCEQF",
		"VCEQG",
		"VCEQBS",
		"VCEQHS",
		"VCEQFS",
		"VCEQGS",
		"VCH",
		"VCHB",
		"VCHH",
		"VCHF",
		"VCHG",
		"VCHBS",
		"VCHHS",
		"VCHFS",
		"VCHGS",
		"VCHL",
		"VCHLB",
		"VCHLH",
		"VCHLF",
		"VCHLG",
		"VCHLBS",
		"VCHLHS",
		"VCHLFS",
		"VCHLGS",
		"VCLZ",
		"VCLZB",
		"VCLZH",
		"VCLZF",
		"VCLZG",
		"VCTZ",
		"VCTZB",
		"VCTZH",
		"VCTZF",
		"VCTZG",
		"VEC",
		"VECB",
		"VECH",
		"VECF",
		"VECG",
		"VECL",
		"VECLB",
		"VECLH",
		"VECLF",
		"VECLG",
		"VERIM",
		"VERIMB",
		"VERIMH",
		"VERIMF",
		"VERIMG",
		"VERLL",
		"VERLLB",
		"VERLLH",
		"VERLLF",
		"VERLLG",
		"VERLLV",
		"VERLLVB",
		"VERLLVH",
		"VERLLVF",
		"VERLLVG",
		"VESLV",
		"VESLVB",
		"VESLVH",
		"VESLVF",
		"VESLVG",
		"VESL",
		"VESLB",
		"VESLH",
		"VESLF",
		"VESLG",
		"VESRA",
		"VESRAB",
		"VESRAH",
		"VESRAF",
		"VESRAG",
		"VESRAV",
		"VESRAVB",
		"VESRAVH",
		"VESRAVF",
		"VESRAVG",
		"VESRL",
		"VESRLB",
		"VESRLH",
		"VESRLF",
		"VESRLG",
		"VESRLV",
		"VESRLVB",
		"VESRLVH",
		"VESRLVF",
		"VESRLVG",
		"VX",
		"VFAE",
		"VFAEB",
		"VFAEH",
		"VFAEF",
		"VFAEBS",
		"VFAEHS",
		"VFAEFS",
		"VFAEZB",
		"VFAEZH",
		"VFAEZF",
		"VFAEZBS",
		"VFAEZHS",
		"VFAEZFS",
		"VFEE",
		"VFEEB",
		"VFEEH",
		"VFEEF",
		"VFEEBS",
		"VFEEHS",
		"VFEEFS",
		"VFEEZB",
		"VFEEZH",
		"VFEEZF",
		"VFEEZBS",
		"VFEEZHS",
		"VFEEZFS",
		"VFENE",
		"VFENEB",
		"VFENEH",
		"VFENEF",
		"VFENEBS",
		"VFENEHS",
		"VFENEFS",
		"VFENEZB",
		"VFENEZH",
		"VFENEZF",
		"VFENEZBS",
		"VFENEZHS",
		"VFENEZFS",
		"VFA",
		"VFADB",
		"WFADB",
		"WFK",
		"WFKDB",
		"VFCE",
		"VFCEDB",
		"VFCEDBS",
		"WFCEDB",
		"WFCEDBS",
		"VFCH",
		"VFCHDB",
		"VFCHDBS",
		"WFCHDB",
		"WFCHDBS",
		"VFCHE",
		"VFCHEDB",
		"VFCHEDBS",
		"WFCHEDB",
		"WFCHEDBS",
		"WFC",
		"WFCDB",
		"VCDG",
		"VCDGB",
		"WCDGB",
		"VCDLG",
		"VCDLGB",
		"WCDLGB",
		"VCGD",
		"VCGDB",
		"WCGDB",
		"VCLGD",
		"VCLGDB",
		"WCLGDB",
		"VFD",
		"VFDDB",
		"WFDDB",
		"VLDE",
		"VLDEB",
		"WLDEB",
		"VLED",
		"VLEDB",
		"WLEDB",
		"VFM",
		"VFMDB",
		"WFMDB",
		"VFMA",
		"VFMADB",
		"WFMADB",
		"VFMS",
		"VFMSDB",
		"WFMSDB",
		"VFPSO",
		"VFPSODB",
		"WFPSODB",
		"VFLCDB",
		"WFLCDB",
		"VFLNDB",
		"WFLNDB",
		"VFLPDB",
		"WFLPDB",
		"VFSQ",
		"VFSQDB",
		"WFSQDB",
		"VFS",
		"VFSDB",
		"WFSDB",
		"VFTCI",
		"VFTCIDB",
		"WFTCIDB",
		"VGFM",
		"VGFMB",
		"VGFMH",
		"VGFMF",
		"VGFMG",
		"VGFMA",
		"VGFMAB",
		"VGFMAH",
		"VGFMAF",
		"VGFMAG",
		"VGEF",
		"VGEG",
		"VGBM",
		"VZERO",
		"VONE",
		"VGM",
		"VGMB",
		"VGMH",
		"VGMF",
		"VGMG",
		"VISTR",
		"VISTRB",
		"VISTRH",
		"VISTRF",
		"VISTRBS",
		"VISTRHS",
		"VISTRFS",
		"VL",
		"VLR",
		"VLREP",
		"VLREPB",
		"VLREPH",
		"VLREPF",
		"VLREPG",
		"VLC",
		"VLCB",
		"VLCH",
		"VLCF",
		"VLCG",
		"VLEH",
		"VLEF",
		"VLEG",
		"VLEB",
		"VLEIH",
		"VLEIF",
		"VLEIG",
		"VLEIB",
		"VFI",
		"VFIDB",
		"WFIDB",
		"VLGV",
		"VLGVB",
		"VLGVH",
		"VLGVF",
		"VLGVG",
		"VLLEZ",
		"VLLEZB",
		"VLLEZH",
		"VLLEZF",
		"VLLEZG",
		"VLM",
		"VLP",
		"VLPB",
		"VLPH",
		"VLPF",
		"VLPG",
		"VLBB",
		"VLVG",
		"VLVGB",
		"VLVGH",
		"VLVGF",
		"VLVGG",
		"VLVGP",
		"VLL",
		"VMX",
		"VMXB",
		"VMXH",
		"VMXF",
		"VMXG",
		"VMXL",
		"VMXLB",
		"VMXLH",
		"VMXLF",
		"VMXLG",
		"VMRH",
		"VMRHB",
		"VMRHH",
		"VMRHF",
		"VMRHG",
		"VMRL",
		"VMRLB",
		"VMRLH",
		"VMRLF",
		"VMRLG",
		"VMN",
		"VMNB",
		"VMNH",
		"VMNF",
		"VMNG",
		"VMNL",
		"VMNLB",
		"VMNLH",
		"VMNLF",
		"VMNLG",
		"VMAE",
		"VMAEB",
		"VMAEH",
		"VMAEF",
		"VMAH",
		"VMAHB",
		"VMAHH",
		"VMAHF",
		"VMALE",
		"VMALEB",
		"VMALEH",
		"VMALEF",
		"VMALH",
		"VMALHB",
		"VMALHH",
		"VMALHF",
		"VMALO",
		"VMALOB",
		"VMALOH",
		"VMALOF",
		"VMAL",
		"VMALB",
		"VMALHW",
		"VMALF",
		"VMAO",
		"VMAOB",
		"VMAOH",
		"VMAOF",
		"VME",
		"VMEB",
		"VMEH",
		"VMEF",
		"VMH",
		"VMHB",
		"VMHH",
		"VMHF",
		"VMLE",
		"VMLEB",
		"VMLEH",
		"VMLEF",
		"VMLH",
		"VMLHB",
		"VMLHH",
		"VMLHF",
		"VMLO",
		"VMLOB",
		"VMLOH",
		"VMLOF",
		"VML",
		"VMLB",
		"VMLHW",
		"VMLF",
		"VMO",
		"VMOB",
		"VMOH",
		"VMOF",
		"VNO",
		"VNOT",
		"VO",
		"VPK",
		"VPKH",
		"VPKF",
		"VPKG",
		"VPKLS",
		"VPKLSH",
		"VPKLSF",
		"VPKLSG",
		"VPKLSHS",
		"VPKLSFS",
		"VPKLSGS",
		"VPKS",
		"VPKSH",
		"VPKSF",
		"VPKSG",
		"VPKSHS",
		"VPKSFS",
		"VPKSGS",
		"VPERM",
		"VPDI",
		"VPOPCT",
		"VREP",
		"VREPB",
		"VREPH",
		"VREPF",
		"VREPG",
		"VREPI",
		"VREPIB",
		"VREPIH",
		"VREPIF",
		"VREPIG",
		"VSCEF",
		"VSCEG",
		"VSEL",
		"VSL",
		"VSLB",
		"VSLDB",
		"VSRA",
		"VSRAB",
		"VSRL",
		"VSRLB",
		"VSEG",
		"VSEGB",
		"VSEGH",
		"VSEGF",
		"VST",
		"VSTEH",
		"VSTEF",
		"VSTEG",
		"VSTEB",
		"VSTM",
		"VSTL",
		"VSTRC",
		"VSTRCB",
		"VSTRCH",
		"VSTRCF",
		"VSTRCBS",
		"VSTRCHS",
		"VSTRCFS",
		"VSTRCZB",
		"VSTRCZH",
		"VSTRCZF",
		"VSTRCZBS",
		"VSTRCZHS",
		"VSTRCZFS",
		"VS",
		"VSB",
		"VSH",
		"VSF",
		"VSG",
		"VSQ",
		"VSCBI",
		"VSCBIB",
		"VSCBIH",
		"VSCBIF",
		"VSCBIG",
		"VSCBIQ",
		"VSBCBI",
		"VSBCBIQ",
		"VSBI",
		"VSBIQ",
		"VSUMG",
		"VSUMGH",
		"VSUMGF",
		"VSUMQ",
		"VSUMQF",
		"VSUMQG",
		"VSUM",
		"VSUMB",
		"VSUMH",
		"VTM",
		"VUPH",
		"VUPHB",
		"VUPHH",
		"VUPHF",
		"VUPLH",
		"VUPLHB",
		"VUPLHH",
		"VUPLHF",
		"VUPLL",
		"VUPLLB",
		"VUPLLH",
		"VUPLLF",
		"VUPL",
		"VUPLB",
		"VUPLHW",
		"VUPLF",
		"VMSLG",
		"BYTE",
		"WORD",
		"DWORD",
		"LAST",
	}
	psess.cnamesz = []string{
		"NONE",
		"REG",
		"FREG",
		"VREG",
		"AREG",
		"ZCON",
		"SCON",
		"UCON",
		"ADDCON",
		"ANDCON",
		"LCON",
		"DCON",
		"SACON",
		"LACON",
		"DACON",
		"SBRA",
		"LBRA",
		"SAUTO",
		"LAUTO",
		"ZOREG",
		"SOREG",
		"LOREG",
		"TLS_LE",
		"TLS_IE",
		"GOK",
		"ADDR",
		"SYMADDR",
		"GOTADDR",
		"TEXTSIZE",
		"ANY",
		"NCLASS",
	}
	psess.optab = []Optab{

		Optab{obj.ATEXT, C_ADDR, C_NONE, C_NONE, C_TEXTSIZE, 0, 0},
		Optab{obj.ATEXT, C_ADDR, C_NONE, C_LCON, C_TEXTSIZE, 0, 0},

		Optab{AMOVD, C_REG, C_NONE, C_NONE, C_REG, 1, 0},
		Optab{AMOVB, C_REG, C_NONE, C_NONE, C_REG, 1, 0},
		Optab{AMOVBZ, C_REG, C_NONE, C_NONE, C_REG, 1, 0},
		Optab{AMOVW, C_REG, C_NONE, C_NONE, C_REG, 1, 0},
		Optab{AMOVWZ, C_REG, C_NONE, C_NONE, C_REG, 1, 0},
		Optab{AFMOVD, C_FREG, C_NONE, C_NONE, C_FREG, 1, 0},
		Optab{AMOVDBR, C_REG, C_NONE, C_NONE, C_REG, 1, 0},

		Optab{AMOVD, C_LACON, C_NONE, C_NONE, C_REG, 26, REGSP},
		Optab{AMOVW, C_LACON, C_NONE, C_NONE, C_REG, 26, REGSP},
		Optab{AMOVWZ, C_LACON, C_NONE, C_NONE, C_REG, 26, REGSP},
		Optab{AMOVD, C_DCON, C_NONE, C_NONE, C_REG, 3, 0},
		Optab{AMOVW, C_DCON, C_NONE, C_NONE, C_REG, 3, 0},
		Optab{AMOVWZ, C_DCON, C_NONE, C_NONE, C_REG, 3, 0},
		Optab{AMOVB, C_DCON, C_NONE, C_NONE, C_REG, 3, 0},
		Optab{AMOVBZ, C_DCON, C_NONE, C_NONE, C_REG, 3, 0},

		Optab{AMOVD, C_SCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVD, C_ADDCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVW, C_SCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVW, C_ADDCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVWZ, C_SCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVWZ, C_ADDCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVB, C_SCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVB, C_ADDCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVBZ, C_SCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVBZ, C_ADDCON, C_NONE, C_NONE, C_LAUTO, 72, REGSP},
		Optab{AMOVD, C_SCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVD, C_ADDCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVW, C_SCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVW, C_ADDCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVWZ, C_SCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVWZ, C_ADDCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVB, C_SCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVB, C_ADDCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVBZ, C_SCON, C_NONE, C_NONE, C_LOREG, 72, 0},
		Optab{AMOVBZ, C_ADDCON, C_NONE, C_NONE, C_LOREG, 72, 0},

		Optab{AMOVD, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVW, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVWZ, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVBZ, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVB, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVDBR, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVHBR, C_REG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AMOVD, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVW, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVWZ, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVBZ, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVB, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVDBR, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVHBR, C_REG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AMOVD, C_REG, C_NONE, C_NONE, C_ADDR, 74, 0},
		Optab{AMOVW, C_REG, C_NONE, C_NONE, C_ADDR, 74, 0},
		Optab{AMOVWZ, C_REG, C_NONE, C_NONE, C_ADDR, 74, 0},
		Optab{AMOVBZ, C_REG, C_NONE, C_NONE, C_ADDR, 74, 0},
		Optab{AMOVB, C_REG, C_NONE, C_NONE, C_ADDR, 74, 0},

		Optab{AMOVD, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVW, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVWZ, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVBZ, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVB, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVDBR, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVHBR, C_LAUTO, C_NONE, C_NONE, C_REG, 36, REGSP},
		Optab{AMOVD, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVW, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVWZ, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVBZ, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVB, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVDBR, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVHBR, C_LOREG, C_NONE, C_NONE, C_REG, 36, 0},
		Optab{AMOVD, C_ADDR, C_NONE, C_NONE, C_REG, 75, 0},
		Optab{AMOVW, C_ADDR, C_NONE, C_NONE, C_REG, 75, 0},
		Optab{AMOVWZ, C_ADDR, C_NONE, C_NONE, C_REG, 75, 0},
		Optab{AMOVBZ, C_ADDR, C_NONE, C_NONE, C_REG, 75, 0},
		Optab{AMOVB, C_ADDR, C_NONE, C_NONE, C_REG, 75, 0},

		Optab{ALAAG, C_REG, C_REG, C_NONE, C_LOREG, 99, 0},

		Optab{AADD, C_REG, C_REG, C_NONE, C_REG, 2, 0},
		Optab{AADD, C_REG, C_NONE, C_NONE, C_REG, 2, 0},
		Optab{AADD, C_LCON, C_REG, C_NONE, C_REG, 22, 0},
		Optab{AADD, C_LCON, C_NONE, C_NONE, C_REG, 22, 0},
		Optab{AADD, C_LOREG, C_NONE, C_NONE, C_REG, 12, 0},
		Optab{AADD, C_LAUTO, C_NONE, C_NONE, C_REG, 12, REGSP},
		Optab{ASUB, C_LCON, C_REG, C_NONE, C_REG, 21, 0},
		Optab{ASUB, C_LCON, C_NONE, C_NONE, C_REG, 21, 0},
		Optab{ASUB, C_LOREG, C_NONE, C_NONE, C_REG, 12, 0},
		Optab{ASUB, C_LAUTO, C_NONE, C_NONE, C_REG, 12, REGSP},
		Optab{AMULHD, C_REG, C_NONE, C_NONE, C_REG, 4, 0},
		Optab{AMULHD, C_REG, C_REG, C_NONE, C_REG, 4, 0},
		Optab{ADIVW, C_REG, C_REG, C_NONE, C_REG, 2, 0},
		Optab{ADIVW, C_REG, C_NONE, C_NONE, C_REG, 2, 0},
		Optab{ASUB, C_REG, C_REG, C_NONE, C_REG, 10, 0},
		Optab{ASUB, C_REG, C_NONE, C_NONE, C_REG, 10, 0},
		Optab{ANEG, C_REG, C_NONE, C_NONE, C_REG, 47, 0},
		Optab{ANEG, C_NONE, C_NONE, C_NONE, C_REG, 47, 0},

		Optab{AAND, C_REG, C_REG, C_NONE, C_REG, 6, 0},
		Optab{AAND, C_REG, C_NONE, C_NONE, C_REG, 6, 0},
		Optab{AAND, C_LCON, C_NONE, C_NONE, C_REG, 23, 0},
		Optab{AAND, C_LOREG, C_NONE, C_NONE, C_REG, 12, 0},
		Optab{AAND, C_LAUTO, C_NONE, C_NONE, C_REG, 12, REGSP},
		Optab{AANDW, C_REG, C_REG, C_NONE, C_REG, 6, 0},
		Optab{AANDW, C_REG, C_NONE, C_NONE, C_REG, 6, 0},
		Optab{AANDW, C_LCON, C_NONE, C_NONE, C_REG, 24, 0},
		Optab{AANDW, C_LOREG, C_NONE, C_NONE, C_REG, 12, 0},
		Optab{AANDW, C_LAUTO, C_NONE, C_NONE, C_REG, 12, REGSP},
		Optab{ASLD, C_REG, C_NONE, C_NONE, C_REG, 7, 0},
		Optab{ASLD, C_REG, C_REG, C_NONE, C_REG, 7, 0},
		Optab{ASLD, C_SCON, C_REG, C_NONE, C_REG, 7, 0},
		Optab{ASLD, C_SCON, C_NONE, C_NONE, C_REG, 7, 0},

		Optab{ACSG, C_REG, C_REG, C_NONE, C_SOREG, 79, 0},

		Optab{AFADD, C_FREG, C_NONE, C_NONE, C_FREG, 32, 0},
		Optab{AFABS, C_FREG, C_NONE, C_NONE, C_FREG, 33, 0},
		Optab{AFABS, C_NONE, C_NONE, C_NONE, C_FREG, 33, 0},
		Optab{AFMADD, C_FREG, C_FREG, C_NONE, C_FREG, 34, 0},
		Optab{AFMUL, C_FREG, C_NONE, C_NONE, C_FREG, 32, 0},
		Optab{AFMOVD, C_LAUTO, C_NONE, C_NONE, C_FREG, 36, REGSP},
		Optab{AFMOVD, C_LOREG, C_NONE, C_NONE, C_FREG, 36, 0},
		Optab{AFMOVD, C_ADDR, C_NONE, C_NONE, C_FREG, 75, 0},
		Optab{AFMOVD, C_FREG, C_NONE, C_NONE, C_LAUTO, 35, REGSP},
		Optab{AFMOVD, C_FREG, C_NONE, C_NONE, C_LOREG, 35, 0},
		Optab{AFMOVD, C_FREG, C_NONE, C_NONE, C_ADDR, 74, 0},
		Optab{AFMOVD, C_ZCON, C_NONE, C_NONE, C_FREG, 67, 0},
		Optab{ALDGR, C_REG, C_NONE, C_NONE, C_FREG, 81, 0},
		Optab{ALGDR, C_FREG, C_NONE, C_NONE, C_REG, 81, 0},
		Optab{ACEFBRA, C_REG, C_NONE, C_NONE, C_FREG, 82, 0},
		Optab{ACFEBRA, C_FREG, C_NONE, C_NONE, C_REG, 83, 0},
		Optab{AFIEBR, C_SCON, C_FREG, C_NONE, C_FREG, 48, 0},
		Optab{ACPSDR, C_FREG, C_FREG, C_NONE, C_FREG, 49, 0},
		Optab{ALTDBR, C_FREG, C_NONE, C_NONE, C_FREG, 50, 0},
		Optab{ATCDB, C_FREG, C_NONE, C_NONE, C_SCON, 51, 0},

		Optab{AMOVD, C_SYMADDR, C_NONE, C_NONE, C_REG, 19, 0},
		Optab{AMOVD, C_GOTADDR, C_NONE, C_NONE, C_REG, 93, 0},
		Optab{AMOVD, C_TLS_LE, C_NONE, C_NONE, C_REG, 94, 0},
		Optab{AMOVD, C_TLS_IE, C_NONE, C_NONE, C_REG, 95, 0},

		Optab{ASYSCALL, C_NONE, C_NONE, C_NONE, C_NONE, 5, 0},
		Optab{ASYSCALL, C_SCON, C_NONE, C_NONE, C_NONE, 77, 0},

		Optab{ABEQ, C_NONE, C_NONE, C_NONE, C_SBRA, 16, 0},
		Optab{ABR, C_NONE, C_NONE, C_NONE, C_LBRA, 11, 0},
		Optab{ABC, C_SCON, C_REG, C_NONE, C_LBRA, 16, 0},
		Optab{ABR, C_NONE, C_NONE, C_NONE, C_REG, 18, 0},
		Optab{ABR, C_REG, C_NONE, C_NONE, C_REG, 18, 0},
		Optab{ABR, C_NONE, C_NONE, C_NONE, C_ZOREG, 15, 0},
		Optab{ABC, C_NONE, C_NONE, C_NONE, C_ZOREG, 15, 0},
		Optab{ACMPBEQ, C_REG, C_REG, C_NONE, C_SBRA, 89, 0},
		Optab{ACMPBEQ, C_REG, C_NONE, C_ADDCON, C_SBRA, 90, 0},
		Optab{ACMPBEQ, C_REG, C_NONE, C_SCON, C_SBRA, 90, 0},
		Optab{ACMPUBEQ, C_REG, C_REG, C_NONE, C_SBRA, 89, 0},
		Optab{ACMPUBEQ, C_REG, C_NONE, C_ANDCON, C_SBRA, 90, 0},

		Optab{AMOVDEQ, C_REG, C_NONE, C_NONE, C_REG, 17, 0},

		Optab{AFLOGR, C_REG, C_NONE, C_NONE, C_REG, 8, 0},

		Optab{ACMP, C_REG, C_NONE, C_NONE, C_REG, 70, 0},
		Optab{ACMP, C_REG, C_NONE, C_NONE, C_LCON, 71, 0},
		Optab{ACMPU, C_REG, C_NONE, C_NONE, C_REG, 70, 0},
		Optab{ACMPU, C_REG, C_NONE, C_NONE, C_LCON, 71, 0},
		Optab{AFCMPO, C_FREG, C_NONE, C_NONE, C_FREG, 70, 0},
		Optab{AFCMPO, C_FREG, C_REG, C_NONE, C_FREG, 70, 0},

		Optab{ATMHH, C_REG, C_NONE, C_NONE, C_ANDCON, 91, 0},

		Optab{AMOVW, C_AREG, C_NONE, C_NONE, C_REG, 68, 0},
		Optab{AMOVWZ, C_AREG, C_NONE, C_NONE, C_REG, 68, 0},
		Optab{AMOVW, C_REG, C_NONE, C_NONE, C_AREG, 69, 0},
		Optab{AMOVWZ, C_REG, C_NONE, C_NONE, C_AREG, 69, 0},

		Optab{ACLEAR, C_LCON, C_NONE, C_NONE, C_LOREG, 96, 0},
		Optab{ACLEAR, C_LCON, C_NONE, C_NONE, C_LAUTO, 96, REGSP},

		Optab{ASTMG, C_REG, C_REG, C_NONE, C_LOREG, 97, 0},
		Optab{ASTMG, C_REG, C_REG, C_NONE, C_LAUTO, 97, REGSP},
		Optab{ALMG, C_LOREG, C_REG, C_NONE, C_REG, 98, 0},
		Optab{ALMG, C_LAUTO, C_REG, C_NONE, C_REG, 98, REGSP},

		Optab{ABYTE, C_SCON, C_NONE, C_NONE, C_NONE, 40, 0},
		Optab{AWORD, C_LCON, C_NONE, C_NONE, C_NONE, 40, 0},
		Optab{ADWORD, C_LCON, C_NONE, C_NONE, C_NONE, 31, 0},
		Optab{ADWORD, C_DCON, C_NONE, C_NONE, C_NONE, 31, 0},

		Optab{ASYNC, C_NONE, C_NONE, C_NONE, C_NONE, 80, 0},

		Optab{ASTCK, C_NONE, C_NONE, C_NONE, C_SAUTO, 88, REGSP},
		Optab{ASTCK, C_NONE, C_NONE, C_NONE, C_SOREG, 88, 0},

		Optab{AMVC, C_SCON, C_NONE, C_LOREG, C_LOREG, 84, 0},
		Optab{AMVC, C_SCON, C_NONE, C_LOREG, C_LAUTO, 84, REGSP},
		Optab{AMVC, C_SCON, C_NONE, C_LAUTO, C_LAUTO, 84, REGSP},

		Optab{ALARL, C_LCON, C_NONE, C_NONE, C_REG, 85, 0},
		Optab{ALARL, C_SYMADDR, C_NONE, C_NONE, C_REG, 85, 0},
		Optab{ALA, C_SOREG, C_NONE, C_NONE, C_REG, 86, 0},
		Optab{ALA, C_SAUTO, C_NONE, C_NONE, C_REG, 86, REGSP},
		Optab{AEXRL, C_SYMADDR, C_NONE, C_NONE, C_REG, 87, 0},

		Optab{obj.AUNDEF, C_NONE, C_NONE, C_NONE, C_NONE, 78, 0},
		Optab{obj.APCDATA, C_LCON, C_NONE, C_NONE, C_LCON, 0, 0},
		Optab{obj.AFUNCDATA, C_SCON, C_NONE, C_NONE, C_ADDR, 0, 0},
		Optab{obj.ANOP, C_NONE, C_NONE, C_NONE, C_NONE, 0, 0},
		Optab{obj.ANOP, C_SAUTO, C_NONE, C_NONE, C_NONE, 0, 0},

		Optab{AVST, C_VREG, C_NONE, C_NONE, C_SOREG, 100, 0},
		Optab{AVST, C_VREG, C_NONE, C_NONE, C_SAUTO, 100, REGSP},
		Optab{AVSTEG, C_SCON, C_VREG, C_NONE, C_SOREG, 100, 0},
		Optab{AVSTEG, C_SCON, C_VREG, C_NONE, C_SAUTO, 100, REGSP},

		Optab{AVL, C_SOREG, C_NONE, C_NONE, C_VREG, 101, 0},
		Optab{AVL, C_SAUTO, C_NONE, C_NONE, C_VREG, 101, REGSP},
		Optab{AVLEG, C_SCON, C_NONE, C_SOREG, C_VREG, 101, 0},
		Optab{AVLEG, C_SCON, C_NONE, C_SAUTO, C_VREG, 101, REGSP},

		Optab{AVSCEG, C_SCON, C_VREG, C_NONE, C_SOREG, 102, 0},
		Optab{AVSCEG, C_SCON, C_VREG, C_NONE, C_SAUTO, 102, REGSP},

		Optab{AVGEG, C_SCON, C_NONE, C_SOREG, C_VREG, 103, 0},
		Optab{AVGEG, C_SCON, C_NONE, C_SAUTO, C_VREG, 103, REGSP},

		Optab{AVESLG, C_SCON, C_VREG, C_NONE, C_VREG, 104, 0},
		Optab{AVESLG, C_REG, C_VREG, C_NONE, C_VREG, 104, 0},
		Optab{AVESLG, C_SCON, C_NONE, C_NONE, C_VREG, 104, 0},
		Optab{AVESLG, C_REG, C_NONE, C_NONE, C_VREG, 104, 0},
		Optab{AVLGVG, C_SCON, C_VREG, C_NONE, C_REG, 104, 0},
		Optab{AVLGVG, C_REG, C_VREG, C_NONE, C_REG, 104, 0},
		Optab{AVLVGG, C_SCON, C_REG, C_NONE, C_VREG, 104, 0},
		Optab{AVLVGG, C_REG, C_REG, C_NONE, C_VREG, 104, 0},

		Optab{AVSTM, C_VREG, C_VREG, C_NONE, C_SOREG, 105, 0},
		Optab{AVSTM, C_VREG, C_VREG, C_NONE, C_SAUTO, 105, REGSP},

		Optab{AVLM, C_SOREG, C_VREG, C_NONE, C_VREG, 106, 0},
		Optab{AVLM, C_SAUTO, C_VREG, C_NONE, C_VREG, 106, REGSP},

		Optab{AVSTL, C_REG, C_VREG, C_NONE, C_SOREG, 107, 0},
		Optab{AVSTL, C_REG, C_VREG, C_NONE, C_SAUTO, 107, REGSP},

		Optab{AVLL, C_REG, C_NONE, C_SOREG, C_VREG, 108, 0},
		Optab{AVLL, C_REG, C_NONE, C_SAUTO, C_VREG, 108, REGSP},

		Optab{AVGBM, C_ANDCON, C_NONE, C_NONE, C_VREG, 109, 0},
		Optab{AVZERO, C_NONE, C_NONE, C_NONE, C_VREG, 109, 0},
		Optab{AVREPIG, C_ADDCON, C_NONE, C_NONE, C_VREG, 109, 0},
		Optab{AVREPIG, C_SCON, C_NONE, C_NONE, C_VREG, 109, 0},
		Optab{AVLEIG, C_SCON, C_NONE, C_ADDCON, C_VREG, 109, 0},
		Optab{AVLEIG, C_SCON, C_NONE, C_SCON, C_VREG, 109, 0},

		Optab{AVGMG, C_SCON, C_NONE, C_SCON, C_VREG, 110, 0},

		Optab{AVREPG, C_UCON, C_VREG, C_NONE, C_VREG, 111, 0},

		Optab{AVERIMG, C_SCON, C_VREG, C_VREG, C_VREG, 112, 0},
		Optab{AVSLDB, C_SCON, C_VREG, C_VREG, C_VREG, 112, 0},

		Optab{AVFTCIDB, C_SCON, C_VREG, C_NONE, C_VREG, 113, 0},

		Optab{AVLR, C_VREG, C_NONE, C_NONE, C_VREG, 114, 0},

		Optab{AVECG, C_VREG, C_NONE, C_NONE, C_VREG, 115, 0},

		Optab{AVCEQG, C_VREG, C_VREG, C_NONE, C_VREG, 117, 0},
		Optab{AVFAEF, C_VREG, C_VREG, C_NONE, C_VREG, 117, 0},
		Optab{AVPKSG, C_VREG, C_VREG, C_NONE, C_VREG, 117, 0},

		Optab{AVAQ, C_VREG, C_VREG, C_NONE, C_VREG, 118, 0},
		Optab{AVAQ, C_VREG, C_NONE, C_NONE, C_VREG, 118, 0},
		Optab{AVNOT, C_VREG, C_NONE, C_NONE, C_VREG, 118, 0},
		Optab{AVPDI, C_SCON, C_VREG, C_VREG, C_VREG, 123, 0},

		Optab{AVERLLVG, C_VREG, C_VREG, C_NONE, C_VREG, 119, 0},
		Optab{AVERLLVG, C_VREG, C_NONE, C_NONE, C_VREG, 119, 0},

		Optab{AVACQ, C_VREG, C_VREG, C_VREG, C_VREG, 120, 0},

		Optab{AVSEL, C_VREG, C_VREG, C_VREG, C_VREG, 121, 0},

		Optab{AVLVGP, C_REG, C_REG, C_NONE, C_VREG, 122, 0},
	}
	psess.Links390x = obj.LinkArch{
		Arch:           psess.sys.ArchS390X,
		Init:           psess.buildop,
		Preprocess:     preprocess,
		Assemble:       psess.spanz,
		Progedit:       progedit,
		UnaryDst:       psess.unaryDst,
		DWARFRegisters: psess.S390XDWARFRegisters,
	}
	return psess
}
